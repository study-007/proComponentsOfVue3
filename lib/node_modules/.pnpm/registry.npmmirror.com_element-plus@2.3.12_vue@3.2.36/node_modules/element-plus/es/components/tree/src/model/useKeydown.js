"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const c=require("vue"),b=require("../../../../../../../../registry.npmmirror.com_@vueuse_core@9.13.0_vue@3.2.36/node_modules/@vueuse/core/index.js"),h=require("../../../../hooks/use-namespace/index.js"),n=require("../../../../constants/aria.js");function m({el$:u},f){const o=h.useNamespace("tree"),t=c.shallowRef([]),s=c.shallowRef([]);c.onMounted(()=>{E()}),c.onUpdated(()=>{t.value=Array.from(u.value.querySelectorAll("[role=treeitem]")),s.value=Array.from(u.value.querySelectorAll("input[type=checkbox]"))}),c.watch(s,r=>{r.forEach(l=>{l.setAttribute("tabindex","-1")})});const y=r=>{const l=r.target;if(!l.className.includes(o.b("node")))return;const i=r.code;t.value=Array.from(u.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`));const a=t.value.indexOf(l);let e;if([n.EVENT_CODE.up,n.EVENT_CODE.down].includes(i)){if(r.preventDefault(),i===n.EVENT_CODE.up){e=a===-1?0:a!==0?a-1:t.value.length-1;const d=e;for(;!f.value.getNode(t.value[e].dataset.key).canFocus;){if(e--,e===d){e=-1;break}e<0&&(e=t.value.length-1)}}else{e=a===-1?0:a<t.value.length-1?a+1:0;const d=e;for(;!f.value.getNode(t.value[e].dataset.key).canFocus;){if(e++,e===d){e=-1;break}e>=t.value.length&&(e=0)}}e!==-1&&t.value[e].focus()}[n.EVENT_CODE.left,n.EVENT_CODE.right].includes(i)&&(r.preventDefault(),l.click());const v=l.querySelector('[type="checkbox"]');[n.EVENT_CODE.enter,n.EVENT_CODE.space].includes(i)&&v&&(r.preventDefault(),v.click())};b.useEventListener(u,"keydown",y);const E=()=>{var r;t.value=Array.from(u.value.querySelectorAll(`.${o.is("focusable")}[role=treeitem]`)),s.value=Array.from(u.value.querySelectorAll("input[type=checkbox]"));const l=u.value.querySelectorAll(`.${o.is("checked")}[role=treeitem]`);if(l.length){l[0].setAttribute("tabindex","0");return}(r=t.value[0])==null||r.setAttribute("tabindex","0")}}exports.useKeydown=m;
